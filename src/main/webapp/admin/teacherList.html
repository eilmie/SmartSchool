<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart School System - Teacher List</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/assets/css/teacherList.css">
</head>
<body>
    <header class="header">
        <div class="header-left">
            <i class="fas fa-bars menu-toggle-icon" id="menu-toggle"></i> 
            <span>Smart School System</span>
        </div>
        <div class="header-right">
            <div class="profile-area" id="profileBtn">
                <span class="user-name">Admin</span> 
                <img src="/assets/image/adminICON.png" alt="Admin Profile" class="profile-image">
            </div>
        </div>
    </header>

    <div class="main-container">
        <aside class="sidebar" id="sidebar">
            <ul class="sidebar-menu">
                <li><a href="adminHomepage.html" class="menu-item active"><i class="fas fa-home icon"></i> <span class="link-text">Home</span></a></li>
                <li><a href="class.html" class="menu-item"><i class="fas fa-chalkboard icon"></i> <span class="link-text">Class</span></a></li>
                <li><a href="student.html" class="menu-item"><i class="fas fa-user-graduate icon"></i> <span class="link-text">Student</span></a></li>
                <li><a href="validateTeacher.html" class="menu-item"><i class="fas fa-user-check icon"></i> <span class="link-text">Validate</span></a></li>
                <li><a href="teacherList.html" class="menu-item"><i class="fas fa-users-rectangle icon"></i> <span class="link-text">Teacher List</span></a></li>
                <li><a href="assignment.html" class="menu-item"><i class="fas fa-tasks icon"></i> <span class="link-text">Assignment</span></a></li>
                <li><a href="adminSettings.html" class="menu-item"><i class="fas fa-cog icon"></i> <span class="link-text">Settings</span></a></li>
            </ul>
        </aside>

        <main class="content">
            <div class="breadcrumb">
                Hi, Admin <span class="breadcrumb-separator">&gt;</span> <span class="current-page">Teacher List</span>
            </div>

            <div class="card">
                <div class="controls-row">
                    <div class="filter-group">
                        <label class="filter-label">Status:</label>
                        <select id="statusFilter" class="styled-select" onchange="loadTeachers()">
                            <option value="ACTIVE">Active Teachers</option>
                            <option value="INACTIVE">Inactive Teachers</option>
                        </select>
                    </div>

                    <div class="search-container">
                        <input type="text" id="searchInput" class="form-control" placeholder="Search Teacher Name..." onkeyup="searchTable()">
                        <i class="fas fa-magnifying-glass"></i>
                    </div>
                </div>

                <div class="table-responsive">
                    <table id="teacherTable">
                        <thead>
                            <tr>
                                <th style="width: 50px;">No.</th>
                                <th>Name</th>
                                <th>Certificate No</th>
                                <th>Email</th>
                                <th>Phone No.</th>
                                <th style="width: 100px;">Action</th>
                            </tr>
                        </thead>
                        <tbody id="teacherTableBody">
                            </tbody>
                    </table>
                </div>
            </div>
            <div id="toastNotification" class="notification-toast">Message</div>
        </main>
    </div>

    <div id="editTeacherModal" class="modal-overlay">
        <div class="beige-modal">
            <span class="close-icon" onclick="closeEditModal()">&times;</span>
            <h3>Edit Teacher</h3>
            <form action="/admin/TeacherListServlet" method="post">
                <input type="hidden" name="action" value="edit">
                <input type="hidden" id="editTeacherId" name="editTeacherId">
                <div class="form-group"><label>Name</label><input type="text" id="editName" class="edit-input readonly-input" readonly></div>
                <div class="form-group"><label>Phone No.</label><input type="text" id="editPhone" name="editPhone" class="edit-input" required></div>
                <div class="form-group"><label>New Password</label><input type="password" name="editPassword" class="edit-input"></div>
                <div class="form-actions"><button type="submit" class="btn-save-grey">Save</button></div>
            </form>
        </div>
    </div>

    <script>
        window.onload = function() {
            loadTeachers();
        };

        // 1. DATA FETCHING Logic
        function loadTeachers() {
            const status = document.getElementById('statusFilter').value;
            fetch(`/admin/TeacherListServlet?status=${status}`)
                .then(res => res.json())
                .then(data => {
                    const tbody = document.getElementById("teacherTableBody");
                    tbody.innerHTML = data.length ? "" : '<tr><td colspan="6" style="text-align: center; padding: 20px;">No teachers found</td></tr>';
                    data.forEach((t, i) => {
                        tbody.innerHTML += `
                            <tr>
                                <td>${i + 1}</td>
                                <td>${t.TeacherName}</td>
                                <td>${t.certNumber}</td>
                                <td>${t.TeacherEmail}</td>
                                <td>${t.TeacherPhoneNum}</td>
                                <td class="action-cell">
                                    ${Status === 'Approved' ? `
                                        <div class="action-icons-wrapper">
                                            <div class="action-btn edit-btn" onclick="openEditModal('${t.teacherID}', '${t.teacherName}', '${t.teacherPhoneNum}')">
                                                <i class="fa-regular fa-pen-to-square"></i>
                                            </div>
                                        </div>` : '<span style="color: #999;">(Inactive)</span>'}
                                </td>
                            </tr>`;
                    });
                })
                .catch(err => console.error("Error loading teachers:", err));
        }

        [cite_start]// 2. Original UI Logic: Sidebar and Modal Controls [cite: 172-187]
        function openEditModal(id, name, phone) {
            document.getElementById('editTeacherId').value = id;
            document.getElementById('editName').value = name;
            document.getElementById('editPhone').value = phone;
            document.getElementById('editTeacherModal').style.display = 'flex';
        }

        function closeEditModal() { document.getElementById('editTeacherModal').style.display = 'none'; }
        
        const menuToggle = document.getElementById('menu-toggle');
        if (menuToggle) menuToggle.addEventListener('click', () => document.getElementById('sidebar').classList.toggle('collapsed'));
    </script>
</body>
</html>