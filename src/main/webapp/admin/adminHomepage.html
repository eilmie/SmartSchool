<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart School System - Admin Home</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/assets/css/validate.css">
</head>

<body>

    <header class="header">
        <div class="header-left">
            <i class="fas fa-bars menu-toggle-icon" id="menu-toggle"></i> 
            <span>Smart School System</span>
        </div>
        <div class="header-right">
            <div class="profile-area" id="profileBtn">
                <span class="user-name">Admin</span> 
                <img src="/assets/image/adminICON.png" alt="Admin Profile" class="profile-image">
            </div>
            <div class="profile-menu" id="profileMenu">
                <p onclick="location.href='adminProfile.html'">
                    <i class="fas fa-user"></i> My Profile
                </p>
                <p id="logoutOption">
                    <i class="fas fa-sign-out-alt"></i> Logout
                </p>
            </div>
        </div>
    </header>

    <div class="main-container">
        <aside class="sidebar" id="sidebar">
            <ul class="sidebar-menu">
                <li><a href="adminHomepage.html" class="menu-item active"><i class="fas fa-home icon"></i> <span class="link-text">Home</span></a></li>
                <li><a href="class.html" class="menu-item"><i class="fas fa-chalkboard icon"></i> <span class="link-text">Class</span></a></li>
                <li><a href="student.html" class="menu-item"><i class="fas fa-user-graduate icon"></i> <span class="link-text">Student</span></a></li>
                <li><a href="validateTeacher.html" class="menu-item"><i class="fas fa-user-check icon"></i> <span class="link-text">Validate</span></a></li>
                <li><a href="teacherList.html" class="menu-item"><i class="fas fa-users-rectangle icon"></i> <span class="link-text">Teacher List</span></a></li>
                <li><a href="assignment.html" class="menu-item"><i class="fas fa-tasks icon"></i> <span class="link-text">Assignment</span></a></li>
                <li><a href="adminSettings.html" class="menu-item"><i class="fas fa-cog icon"></i> <span class="link-text">Settings</span></a></li>
            </ul>
        </aside>

        <main class="content">
            <div class="breadcrumb">
                Hi, Admin <span class="breadcrumb-separator">&gt;</span> <span class="current-page">Dashboard</span>
            </div>

            <div class="stats-container">
                <div class="stat-item">
                    <span class="stat-value" id="totalStudents">0</span> 
                    <span class="stat-label">Total Students</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value" id="totalTeachers">0</span> 
                    <span class="stat-label">Total Teachers</span>
                </div>
                <div class="stat-item">
                    <span class="stat-value" id="pendingCount" style="color: #ef4444;">0</span>
                    <span class="stat-label">Pending Validation</span>
                </div>
            </div>

            <div class="card-grid">
                <div class="dashboard-card" onclick="location.href='class.html'">
                    <div class="card-icon"><i class="fas fa-chalkboard icon"></i></div>
                    <p>Class</p>
                </div>
                <div class="dashboard-card" onclick="location.href='student.html'">
                    <div class="card-icon"><i class="fas fa-user-graduate"></i></div>
                    <p>Student</p>
                </div>
                <div class="dashboard-card" onclick="location.href='validateTeacher.html'">
                    <div class="card-icon"><i class="fas fa-user-check"></i></div>
                    <p>Validate Accounts</p>
                </div>
                <div class="dashboard-card" onclick="location.href='teacherList.html'">
                    <div class="card-icon"><i class="fas fa-users-rectangle"></i></div>
                    <p>Teacher List</p>
                </div>
                <div class="dashboard-card" onclick="location.href='assignment.html'">
                    <div class="card-icon"><i class="fas fa-tasks"></i></div>
                    <p>Assignment</p>
                </div>
                <div class="dashboard-card" onclick="location.href='adminSettings.html'">
                    <div class="card-icon"><i class="fas fa-cog icon"></i></div>
                    <p>Settings</p>
                </div>
            </div>
        </main>
    </div>

    <div id="logoutModal" class="modal-overlay">
        <div class="modal-box">
            <h3>Confirm Logout</h3>
            <p>Do you want to logout from this account?</p>
            <div class="modal-buttons">
                <button class="modal-btn btn-cancel" id="cancelLogout">Cancel</button>
                <button class="modal-btn btn-reject" id="confirmLogout">Logout</button>
            </div>
        </div>
    </div>

    <script>
        // 1. Sidebar and Menu Toggle 
        document.getElementById('menu-toggle').addEventListener('click', () => {
            document.getElementById('sidebar').classList.toggle('collapsed');
        });

        const profileBtn = document.getElementById('profileBtn');
        const profileMenu = document.getElementById('profileMenu');
        profileBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            profileMenu.style.display = profileMenu.style.display === 'block' ? 'none' : 'block';
        });

        window.addEventListener('click', () => profileMenu.style.display = 'none');

        // 2. Dashboard Statistics Loader (New Fetch Logic)
        window.onload = function() {
            fetch('/AdminStatsServlet')
                .then(response => response.json())
                .then(data => {
                    document.getElementById('totalStudents').innerText = data.totalStudents;
                    document.getElementById('totalTeachers').innerText = data.totalTeachers;
                    document.getElementById('pendingCount').innerText = data.pendingCount;
                })
                .catch(err => console.error('Error loading dashboard stats:', err));
        };

        // 3. Logout Logic [cite: 79]
        document.getElementById('logoutOption').addEventListener('click', () => {
            document.getElementById('logoutModal').style.display = 'flex';
        });
        document.getElementById('cancelLogout').addEventListener('click', () => {
            document.getElementById('logoutModal').style.display = 'none';
        });
        document.getElementById('confirmLogout').addEventListener('click', () => {
            window.location.href = '/LogoutServlet';
        });
    </script>
</body>
</html>